@page "/dashboard"

<PageTitle>Comunidad Docente - FIME</PageTitle>

<div class="min-h-screen bg-gradient-to-br from-gray-50 to-blue-50">
    <div class="max-w-7xl mx-auto p-6">
        <!-- Hero Header -->
        <div class="text-center mb-12">
            <div class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-blue-600 to-blue-700 rounded-2xl mb-6 shadow-lg">
                <i class="bi bi-mortarboard-fill text-white text-3xl"></i>
            </div>
            <h1 class="text-5xl font-bold text-gray-800 mb-4">Comunidad Docente FIME</h1>
            <p class="text-gray-600 text-xl max-w-2xl mx-auto leading-relaxed">
                Conecta con profesores, explora materias y participa en la comunidad académica más vibrante
            </p>
        </div>
        
        <!-- Stats Section -->
        <div class="mb-16">
            <div class="flex items-center justify-center mb-8">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-gradient-to-br from-gray-600 to-gray-700 rounded-lg flex items-center justify-center">
                        <i class="bi bi-graph-up-arrow text-white text-sm"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800">Estadísticas de la Comunidad</h2>
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                <!-- Profesores Card -->
                <div class="bg-white rounded-2xl p-8 shadow-xl hover:shadow-2xl hover:-translate-y-3 transition-all duration-300 border border-gray-100 group">
                    <div class="flex flex-col items-center text-center">
                        <div class="w-20 h-20 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center shadow-lg mb-6 group-hover:scale-110 transition-transform duration-300">
                            <i class="bi bi-person-video3 text-3xl text-white"></i>
                        </div>
                        <div>
                            <h3 class="text-sm font-bold text-gray-500 uppercase tracking-wider mb-2 flex items-center justify-center">
                                <i class="bi bi-mortarboard mr-2"></i>
                                Profesores
                            </h3>
                            <p class="text-4xl font-bold text-blue-600 mb-2">@profesoresCount</p>
                            <span class="text-sm text-gray-500 font-medium flex items-center justify-center">
                                <i class="bi bi-check-circle-fill text-green-500 mr-1"></i>
                                Activos en la comunidad
                            </span>
                        </div>
                    </div>
                </div>
                
                <!-- Materias Card -->
                <div class="bg-white rounded-2xl p-8 shadow-xl hover:shadow-2xl hover:-translate-y-3 transition-all duration-300 border border-gray-100 group">
                    <div class="flex flex-col items-center text-center">
                        <div class="w-20 h-20 bg-gradient-to-br from-green-500 to-green-600 rounded-2xl flex items-center justify-center shadow-lg mb-6 group-hover:scale-110 transition-transform duration-300">
                            <i class="bi bi-journal-bookmark text-3xl text-black"></i>
                        </div>
                        <div>
                            <h3 class="text-sm font-bold text-gray-500 uppercase tracking-wider mb-2 flex items-center justify-center">
                                <i class="bi bi-book mr-2"></i>
                                Materias
                            </h3>
                            <p class="text-4xl font-bold text-green-600 mb-2">@materiasCount</p>
                            <span class="text-sm text-gray-500 font-medium flex items-center justify-center">
                                <i class="bi bi-collection text-indigo-500 mr-1"></i>
                                Disponibles
                            </span>
                        </div>
                    </div>
                </div>
                
                <!-- Comentarios Card -->
                <div class="bg-white rounded-2xl p-8 shadow-xl hover:shadow-2xl hover:-translate-y-3 transition-all duration-300 border border-gray-100 group">
                    <div class="flex flex-col items-center text-center">
                        <div class="w-20 h-20 bg-gradient-to-br from-purple-500 to-purple-600 rounded-2xl flex items-center justify-center shadow-lg mb-6 group-hover:scale-110 transition-transform duration-300">
                            <i class="bi bi-chat-heart text-3xl text-black"></i>
                        </div>
                        <div>
                            <h3 class="text-sm font-bold text-gray-500 uppercase tracking-wider mb-2 flex items-center justify-center">
                                <i class="bi bi-chat-dots mr-2"></i>
                                Comentarios
                            </h3>
                            <p class="text-4xl font-bold text-purple-600 mb-2">@comentariosCount</p>
                            <span class="text-sm text-gray-500 font-medium flex items-center justify-center">
                                <i class="bi bi-calendar-week text-purple-500 mr-1"></i>
                                Esta semana
                            </span>
                        </div>
                    </div>
                </div>
                
                <!-- Evaluaciones Card -->
                <div class="bg-white rounded-2xl p-8 shadow-xl hover:shadow-2xl hover:-translate-y-3 transition-all duration-300 border border-gray-100 group">
                    <div class="flex flex-col items-center text-center">
                        <div class="w-20 h-20 bg-gradient-to-br from-yellow-500 to-yellow-600 rounded-2xl flex items-center justify-center shadow-lg mb-6 group-hover:scale-110 transition-transform duration-300">
                            <i class="bi bi-star-half text-3xl text-black"></i>
                        </div>
                        <div>
                            <h3 class="text-sm font-bold text-gray-500 uppercase tracking-wider mb-2 flex items-center justify-center">
                                <i class="bi bi-clipboard-data mr-2"></i>
                                Evaluaciones
                            </h3>
                            <p class="text-4xl font-bold text-yellow-600 mb-2">@evaluacionesCount</p>
                            <span class="text-sm text-gray-500 font-medium flex items-center justify-center">
                                <i class="bi bi-trophy text-yellow-500 mr-1"></i>
                                Promedio: 4.5/5
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Profesores Section -->
        <div class="mb-20">
            <!-- Section Header -->
            <div class="text-center mb-12">
                <div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-yellow-400 to-yellow-500 rounded-2xl mb-4 shadow-lg">
                    <i class="bi bi-award text-black text-2xl"></i>
                </div>
                <h2 class="text-4xl font-bold text-gray-800 mb-3">Profesores Destacados</h2>
                <p class="text-gray-600 text-lg max-w-2xl mx-auto mb-6">
                    Conoce a los profesores más valorados por la comunidad estudiantil
                </p>
                <div class="flex justify-center">
                    <button class="bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white px-8 py-4 rounded-xl transition-all duration-200 font-semibold shadow-lg hover:shadow-xl flex items-center space-x-3" 
                            @onclick="ToggleProfesores">
                        <i class="bi @(mostrarTodosProfesores ? "bi-eye-slash-fill" : "bi-eye-fill")"></i>
                        <span>@(mostrarTodosProfesores ? "Ver menos profesores" : "Ver todos los profesores")</span>
                        <i class="bi bi-arrow-right"></i>
                    </button>
                </div>
            </div>
            
            <!-- Profesores Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
                @foreach (var profesor in (mostrarTodosProfesores ? profesores : profesores.Take(8)))
                {
                    <div class="bg-white rounded-2xl p-8 shadow-xl hover:shadow-2xl hover:-translate-y-3 transition-all duration-300 cursor-pointer border border-gray-100 group" 
                         @onclick="() => SeleccionarProfesor(profesor)">
                        
                        <div class="flex flex-col items-center text-center">
                            <!-- Avatar with online status -->
                            <div class="relative mb-6">
                                <div class="w-24 h-24 rounded-full overflow-hidden ring-4 ring-gray-100 group-hover:ring-blue-200 transition-all duration-300 shadow-lg">
                                    <img src="@profesor.Avatar" alt="@profesor.Nombre" class="w-full h-full object-cover" />
                                </div>
                                <div class="absolute -bottom-2 -right-2 w-6 h-6 rounded-full border-3 border-white @(profesor.EnLinea ? "bg-green-500" : "bg-gray-400") shadow-lg"></div>
                            </div>
                            
                            <!-- Profesor Info -->
                            <div class="w-full">
                                <h4 class="text-xl font-bold text-gray-800 mb-2 group-hover:text-blue-600 transition-colors">
                                    @profesor.Nombre
                                </h4>
                                <p class="text-gray-600 text-sm mb-6 font-medium">
                                    @profesor.Titulo
                                </p>
                                
                                <!-- Materias Tags -->
                                <div class="flex flex-wrap justify-center gap-2 mb-6">
                                    @foreach (var materia in profesor.Materias.Take(2))
                                    {
                                        <span class="bg-gradient-to-r from-blue-50 to-blue-100 text-blue-700 px-4 py-2 rounded-full text-xs font-semibold border border-blue-200">
                                            @materia
                                        </span>
                                    }
                                    @if (profesor.Materias.Count > 2)
                                    {
                                        <span class="bg-gradient-to-r from-gray-50 to-gray-100 text-gray-600 px-4 py-2 rounded-full text-xs font-semibold border border-gray-200">
                                            +@(profesor.Materias.Count - 2) más
                                        </span>
                                    }
                                </div>
                                
                                <!-- Rating -->
                                <div class="flex items-center justify-center gap-1 bg-gray-50 rounded-xl p-3">
                                    @for (int i = 1; i <= 5; i++)
                                    {
                                        <i class="@(i <= profesor.Rating ? "bi bi-star-fill text-yellow-400" : "bi bi-star text-gray-300") text-lg"></i>
                                    }
                                    <span class="text-sm text-gray-600 ml-3 font-semibold">
                                        (@profesor.NumeroEvaluaciones)
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            </div>
            
            @if (!mostrarTodosProfesores && profesores.Count > 8)
            {
                <div class="text-center mt-8">
                    <p class="text-gray-500 text-sm">Mostrando 8 de @profesores.Count profesores</p>
                </div>
            }
        </div>

        <!-- Materias Section -->
        <div class="mb-20">
            <!-- Section Header -->
            <div class="text-center mb-12">
                <div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-2xl mb-4 shadow-lg">
                    <i class="bi bi-journal-bookmark-fill text-white text-2xl"></i>
                </div>
                <h2 class="text-4xl font-bold text-gray-800 mb-3">Materias Populares</h2>
                <p class="text-gray-600 text-lg max-w-2xl mx-auto mb-8">
                    Explora las materias más demandadas y mejor evaluadas por los estudiantes
                </p>
                
                <!-- Filter Section -->
                <div class="flex flex-col sm:flex-row justify-center items-center space-y-4 sm:space-y-0 sm:space-x-6">
                    <div class="flex items-center space-x-3">
                        <i class="bi bi-funnel text-indigo-600 text-lg"></i>
                        <label class="text-sm font-semibold text-gray-700">Filtrar por carrera:</label>
                    </div>
                    <select class="px-6 py-3 border-2 border-indigo-200 rounded-xl bg-white shadow-lg focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 transition-all duration-200 font-medium text-gray-700" 
                            @onchange="FiltrarMaterias">
                        <option value="">🎓 Todas las carreras</option>
                        <option value="Ingeniería Civil">🏗️ Ingeniería Civil</option>
                        <option value="Ingeniería Mecánica">⚙️ Ingeniería Mecánica</option>
                        <option value="Ingeniería Industrial">🏭 Ingeniería Industrial</option>
                        <option value="Ingeniería Eléctrica">⚡ Ingeniería Eléctrica</option>
                    </select>
                </div>
            </div>
            
            @if (materiasFiltradas.Any())
            {
                <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
                    @foreach (var materia in materiasFiltradas)
                    {
                        <div class="bg-white rounded-xl p-6 shadow-lg hover:shadow-xl hover:-translate-y-2 transition-all duration-300 border border-gray-100 group">
                            <div class="flex justify-between items-start mb-4">
                                <div class="flex-1">
                                    <div class="flex items-center space-x-3 mb-2">
                                        <div class="w-8 h-8 bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-lg flex items-center justify-center">
                                            <i class="bi bi-journal-text text-white text-sm"></i>
                                        </div>
                                        <h4 class="text-lg font-bold text-gray-800 group-hover:text-indigo-600 transition-colors">@materia.Nombre</h4>
                                    </div>
                                    <span class="bg-indigo-50 text-indigo-700 px-3 py-1 rounded-full text-xs font-semibold border border-indigo-200">
                                        @materia.Codigo
                                    </span>
                                </div>
                            </div>
                            
                            <div class="mb-4">
                                <p class="text-blue-600 font-semibold mb-3 flex items-center">
                                    <i class="bi bi-mortarboard mr-2"></i>
                                    @materia.Carrera
                                </p>
                                
                                <div class="mb-4">
                                    <p class="text-sm font-medium text-gray-700 mb-2">
                                        <i class="bi bi-person-check mr-1"></i>
                                        Profesores:
                                    </p>
                                    <div class="flex flex-wrap gap-1">
                                        @foreach (var profesor in materia.Profesores)
                                        {
                                            <span class="bg-gray-100 text-gray-700 px-2 py-1 rounded-md text-xs font-medium">
                                                @profesor
                                            </span>
                                        }
                                    </div>
                                </div>
                            </div>
                            
                            <div class="flex justify-between items-center pt-4 border-t border-gray-100">
                                <div class="flex items-center space-x-4">
                                    <span class="text-xs text-gray-600 flex items-center">
                                        <i class="bi bi-people-fill mr-1 text-green-500"></i> 
                                        @materia.NumeroEstudiantes
                                    </span>
                                    <span class="text-xs text-gray-600 flex items-center">
                                        <i class="bi bi-star-fill mr-1 text-yellow-500"></i> 
                                        @materia.Rating.ToString("F1")
                                    </span>
                                </div>
                                <button class="text-indigo-600 hover:text-indigo-800 text-sm font-medium transition-colors">
                                    Ver detalles <i class="bi bi-arrow-right ml-1"></i>
                                </button>
                            </div>
                        </div>
                    }
                </div>
            }
            else
            {
                <div class="text-center py-12">
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="bi bi-search text-gray-400 text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-medium text-gray-900 mb-2">No se encontraron materias</h3>
                    <p class="text-gray-500">Intenta con un filtro diferente</p>
                </div>
            }
        </div>


    </div>
</div>



@code {
    // Estadísticas
    private int profesoresCount = 0;
    private int materiasCount = 0;
    private int comentariosCount = 0;
    private int evaluacionesCount = 0;

    // Profesores
    private List<Profesor> profesores = new();
    private bool mostrarTodosProfesores = false;

    // Materias
    private List<Materia> materias = new();
    private List<Materia> materiasFiltradas = new();



    protected override async Task OnInitializedAsync()
    {
        await CargarDatosComunidad();
    }

    private async Task CargarDatosComunidad()
    {
        await Task.Delay(500); // Simular carga

        var random = new Random();
        
        // Estadísticas
        profesoresCount = random.Next(45, 85);
        materiasCount = random.Next(120, 180);
        comentariosCount = random.Next(25, 60);
        evaluacionesCount = random.Next(200, 400);

        // Cargar profesores
        profesores = new List<Profesor>
        {
            new Profesor { Id = 1, Nombre = "Dr. Ana García", Titulo = "Doctora en Ingeniería Civil", Avatar = "https://images.unsplash.com/photo-1494790108755-2616c96d5e55?w=80&h=80&fit=crop&crop=face", EnLinea = true, Rating = 5, NumeroEvaluaciones = 45, Materias = new List<string> { "Estructuras", "Concreto", "Diseño Sísmico" } },
            new Profesor { Id = 2, Nombre = "Ing. Carlos Mendoza", Titulo = "Maestro en Ingeniería Mecánica", Avatar = "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=80&h=80&fit=crop&crop=face", EnLinea = false, Rating = 4, NumeroEvaluaciones = 32, Materias = new List<string> { "Termodinámica", "Mecánica de Fluidos" } },
            new Profesor { Id = 3, Nombre = "Dra. Laura Rodríguez", Titulo = "Doctora en Ingeniería Industrial", Avatar = "https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=80&h=80&fit=crop&crop=face", EnLinea = true, Rating = 5, NumeroEvaluaciones = 67, Materias = new List<string> { "Investigación de Operaciones", "Control de Calidad", "Lean Manufacturing" } },
            new Profesor { Id = 4, Nombre = "Ing. Roberto Silva", Titulo = "Maestro en Ingeniería Eléctrica", Avatar = "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=80&h=80&fit=crop&crop=face", EnLinea = true, Rating = 4, NumeroEvaluaciones = 28, Materias = new List<string> { "Circuitos", "Electrónica", "Control Automático" } },
            new Profesor { Id = 5, Nombre = "Dr. Patricia López", Titulo = "Doctora en Matemáticas Aplicadas", Avatar = "https://images.unsplash.com/photo-1580489944761-15a19d654956?w=80&h=80&fit=crop&crop=face", EnLinea = false, Rating = 5, NumeroEvaluaciones = 89, Materias = new List<string> { "Cálculo Diferencial", "Álgebra Lineal", "Ecuaciones Diferenciales" } },
            new Profesor { Id = 6, Nombre = "Ing. Miguel Torres", Titulo = "Maestro en Ingeniería Civil", Avatar = "https://images.unsplash.com/photo-1560250097-0b93528c311a?w=80&h=80&fit=crop&crop=face", EnLinea = true, Rating = 4, NumeroEvaluaciones = 41, Materias = new List<string> { "Hidráulica", "Geotecnia" } },
            new Profesor { Id = 7, Nombre = "Dra. Carmen Jiménez", Titulo = "Doctora en Ingeniería Química", Avatar = "https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?w=80&h=80&fit=crop&crop=face", EnLinea = false, Rating = 5, NumeroEvaluaciones = 53, Materias = new List<string> { "Química Orgánica", "Procesos Industriales", "Catálisis" } },
            new Profesor { Id = 8, Nombre = "Ing. Fernando Vega", Titulo = "Maestro en Sistemas Computacionales", Avatar = "https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?w=80&h=80&fit=crop&crop=face", EnLinea = true, Rating = 4, NumeroEvaluaciones = 36, Materias = new List<string> { "Programación", "Base de Datos", "Redes" } }
        };

        // Cargar materias
        materias = new List<Materia>
        {
            new Materia { Id = 1, Nombre = "Análisis Estructural", Codigo = "IC-301", Carrera = "Ingeniería Civil", Profesores = new List<string> { "Dr. Ana García", "Ing. Miguel Torres" }, NumeroEstudiantes = 45, Rating = 4.5m },
            new Materia { Id = 2, Nombre = "Termodinámica I", Codigo = "IM-201", Carrera = "Ingeniería Mecánica", Profesores = new List<string> { "Ing. Carlos Mendoza" }, NumeroEstudiantes = 38, Rating = 4.2m },
            new Materia { Id = 3, Nombre = "Investigación de Operaciones", Codigo = "II-401", Carrera = "Ingeniería Industrial", Profesores = new List<string> { "Dra. Laura Rodríguez" }, NumeroEstudiantes = 52, Rating = 4.8m },
            new Materia { Id = 4, Nombre = "Circuitos Eléctricos", Codigo = "IE-101", Carrera = "Ingeniería Eléctrica", Profesores = new List<string> { "Ing. Roberto Silva" }, NumeroEstudiantes = 41, Rating = 4.3m },
            new Materia { Id = 5, Nombre = "Cálculo Diferencial", Codigo = "MT-101", Carrera = "Ingeniería Civil", Profesores = new List<string> { "Dr. Patricia López" }, NumeroEstudiantes = 67, Rating = 4.6m },
            new Materia { Id = 6, Nombre = "Mecánica de Fluidos", Codigo = "IM-301", Carrera = "Ingeniería Mecánica", Profesores = new List<string> { "Ing. Carlos Mendoza" }, NumeroEstudiantes = 33, Rating = 4.1m }
        };

        materiasFiltradas = materias;


    }

    private void ToggleProfesores()
    {
        mostrarTodosProfesores = !mostrarTodosProfesores;
    }

    private void SeleccionarProfesor(Profesor profesor)
    {
        // Aquí podrías navegar a la página del profesor o mostrar más detalles
        Console.WriteLine($"Profesor seleccionado: {profesor.Nombre}");
    }

    private void FiltrarMaterias(ChangeEventArgs e)
    {
        var filtro = e.Value?.ToString();
        if (string.IsNullOrEmpty(filtro))
        {
            materiasFiltradas = materias;
        }
        else
        {
            materiasFiltradas = materias.Where(m => m.Carrera == filtro).ToList();
        }
    }


}